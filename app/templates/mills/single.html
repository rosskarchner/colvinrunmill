{% extends "base.html" %}



{% block headextra %}
<script type="text/javascript"
    src="http://maps.google.com/maps/api/js?sensor=false">
</script>

<script>
var markers=[]



m=new google.maps.Marker({
        position: new google.maps.LatLng({{ mill.location.lat }},{{ mill.location.lon }}), 
        title:"{{mill.name|e}}",
        permalink:"{{ url_for('mills/single', mill_no=mill.key().name(), slug=mill.slug)}}"
    });

 markers.push(m);


</script>
{% endblock %}

{% block initjs %}
<script type="text/javascript"> 
  function initialize() {
    var latlng = new google.maps.LatLng({{ mill.location.lat }},{{ mill.location.lon }});
    
var eightteensixtyOptions = {
  getTileUrl: function(coord, zoom) {
    return "/1860/tiles-1860/" + zoom +"/" + coord.x+"/"+coord.y+ ".png";
  },
  tileSize: new google.maps.Size(256, 256),
  isPng: true,
  maxZoom:14,
  minZoom:10,
  name:"What",
  
};
 
var eightteensixtyMapType = new google.maps.ImageMapType(eightteensixtyOptions);
 
    
    
    var myOptions = {
      zoom: 10,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      mapTypeControlOptions: {
       mapTypeIds: [google.maps.MapTypeId.ROADMAP,eightteensixtyMapType]
    }
    };
    var map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions);
        

 map.mapTypes.set("sixty", eightteensixtyMapType);
//map.setMapTypeId("sixty");

   
   // map.overlayMapTypes.insertAt(0, eightteensixtyMapType);
        
        
        
        
        
        
        
        
    var infowindow = new google.maps.InfoWindow()
	for (x in markers){
    	var m= markers[x];
    	m.setMap(map);
 
     	google.maps.event.addListener(m, 'click', function() {
     		var marker=m
     		infowindow.setContent('<a href="'+this.permalink+'">'+ this.title+ '</a>');
     		infowindow.setPosition(this.position);
     		infowindow.open(map);
     		
    		
  		});
    	
    	
    }
  }
 
</script> 
{% endblock %}

{% block extratitle %}: {{mill.name}}{% endblock %}

{% block content %}

<div id="map_canvas"> </div>
<div id="photos">
<h2>Photo Gallery</h2>
{% for photo in photos %}
<div><a href="{{photo.link()}}"><img src="{{ photo.thumb() }}"/></a></div>

{% endfor %}

</div>

{% endblock %}